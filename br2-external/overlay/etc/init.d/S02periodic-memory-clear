#!/bin/sh
#
# Periodic Memory Clear Service Init Script
# Starts background service to periodically clear sensitive memory
#

DAEMON="periodic-memory-clear"
DAEMON_BIN="/usr/bin/periodic-memory-clear"

# Source function library
. /etc/init.d/functions

start() {
    printf "Starting $DAEMON: "
    
    if [ -x "$DAEMON_BIN" ]; then
        $DAEMON_BIN start
        if [ $? -eq 0 ]; then
            echo "OK"
        else
            echo "FAIL"
            return 1
        fi
    else
        echo "FAIL - binary not found"
        return 1
    fi
}

stop() {
    printf "Stopping $DAEMON: "
    
    if [ -x "$DAEMON_BIN" ]; then
        $DAEMON_BIN stop
        echo "OK"
    else
        echo "FAIL - binary not found"
        return 1
    fi
}

restart() {
    stop
    start
}

status() {
    if [ -x "$DAEMON_BIN" ]; then
        $DAEMON_BIN status
    else
        echo "$DAEMON is not available"
        return 1
    fi
}

case "$1" in
    start)
        start
        ;;
    stop)
        stop
        ;;
    restart|reload)
        restart
        ;;
    status)
        status
        ;;
    *)
        echo "Usage: $0 {start|stop|restart|status}"
        exit 1
esac

exit $?